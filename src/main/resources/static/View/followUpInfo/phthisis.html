<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="../../css/followUpInfo/hypertension.css">
    <link rel="stylesheet" href="../../img/iconfont/iconfont.css">
    <script src="../../js/jquery-1.8.0.js"></script>
    <script src="../../js/jquery.util.js"></script>
    <script src="../../js/loginValidate.js"></script>
    <script src="../../js/json2.js"></script>
    <script src="../../img/iconfont/iconfont.js"></script>
    <style>
		.pageBox {position: relative;}
		.wait {
			background: #fff;
			width: 100%;height:100%;
			font-size: 20px;
			line-height: 150px; text-align: center;
			position: absolute; left:0;top:0;
			z-index: 2000;
		}
		.nodata {
			background: #fff;
			width: 100%;height:100%;
			font-size: 18px; 
			display:none;
			text-align: center;
			position: absolute; left:0;top:0;
			z-index: 2000;
		}
		.nodata img {
			display:block; margin: 50px auto;
			width: auto;height:65%;
		} 
	</style>
</head>
<body>
<div class="pageBox">
	<div class="wait">
		请稍等...
	</div> 
	<div class="nodata">
		<img src="../../img/img_zwsj.png"/>
		<div>暂无数据</div>
	</div>
    <div class="pageCont">
        <div class="leftCard">
            <ul class="docUl" id="listUl"></ul>
        </div>
        <div class="rightCard">
            <div class="cardTit">肺结核随访记录</div>
            <ul class="consUl">
                <li class="consLi">
                    <div class="cons-label">治疗月序</div>
                    <div class="cons-txt" id="zlyx" name="zlyx"></div>
                </li>
                <li class="consLi">
                    <div class="cons-label">督导人员</div>
                    <div class="cons-txt" id="ddryName" name="ddryName"></div>
                </li>
                <li class="consLi">
                    <div class="cons-label">随访方式</div>
                    <div class="cons-txt" id="sffsName" name="sffsName"></div>
                </li>
                <li class="consLi">
                    <div class="cons-label">症状及体征</div>
                    <div class="cons-txt" id="zzjtzName" name="zzjtzName"></div>
                </li>
                <li class="consLi">
                    <div class="cons-label">吸烟(支/天)</div>
                    <div class="cons-txt" id="xyl" name="xyl"></div>
                </li>
                <li class="consLi">
                    <div class="cons-label">饮酒(两/天)</div>
                    <div class="cons-txt" id="yjl" name="yjl"></div>
                </li>
                <li class="consLi">
                    <div class="cons-label">化疗方案</div>
                    <div class="cons-txt" id="hlfa" name="hlfa"></div>
                </li>
                <li class="consLi">
                    <div class="cons-label">用法</div>
                    <div class="cons-txt" id="yyyfName" name="yyyfName"></div>
                </li>
                <li class="consLi">
                    <div class="cons-label">药品剂型</div>
                    <div class="cons-txt" id="ypjxName" name="ypjxName"></div>
                </li>
                <li class="consLi">
                    <div class="cons-label">漏服药次数</div>
                    <div class="cons-txt" id="lfycs" name="lfycs"></div>
                </li>
                <li class="consLi">
                    <div class="cons-label">药物不良反应</div>
                    <div class="cons-txt" id="ywblfyms" name="ywblfyms"></div>
                </li>
                <li class="consLi">
                    <div class="cons-label">并发症或合并症</div>
                    <div class="cons-txt" id="bfzhhbzms" name="bfzhhbzms"></div>
                </li>
                <li class="consLi">
                    <div class="cons-label">转诊</div>
                    <div class="cons-txt tizheng">
                        <div>
                            <span class="span-label">科别</span>
                            <span id="zzkb" name="zzkb"></span>
                        </div>
                        <div>
                            <span class="span-label">原因</span>
                            <span id="zzyy" name="zzyy"></span>
                        </div>
                    </div>
                </li>
                <li class="consLi">
                    <div class="cons-label">2周内随访，随访结果</div>
                    <div class="cons-txt" id="zzsfjg" name="zzsfjg"></div>
                </li>
                <li class="consLi">
                    <div class="cons-label">处理意见</div>
                    <div class="cons-txt" id="zzclyj" name="zzclyj"></div>
                </li>
                <li class="consLi">
                    <div class="cons-label">下次随访日期</div>
                    <div class="cons-txt" id="xcsfsj" name="xcsfsj"></div>
                </li>
                <li class="consLi">
                    <div class="cons-label">停止治疗</div>
                    <div class="cons-txt tizheng">
                        <div>
                            <span class="span-label">时间</span>
                            <span id="tzzlsj" name="tzzlsj"></span>
                        </div>
                        <div>
                            <span class="span-label">原因</span>
                            <span id="tzzlyy" name="tzzlyy"></span>
                        </div>
                    </div>
                </li>
                <li class="consLi">
                    <div class="cons-label">全程管理情况</div>
                    <div class="cons-txt tizheng">
                        <div>
                            <span class="span-label">应访视患者次数</span>
                            <span id="yfshzcs" name="yfshzcs"></span>
                        </div>
                        <div>
                            <span class="span-label">实际访视次数</span>
                            <span id="sjfscs" name="sjfscs"></span>
                        </div>
                        <div>
                            <span class="span-label">应服药次数</span>
                            <span id="yfycs" name="yfycs"></span>
                        </div>
                        <div>
                            <span class="span-label">实际服药次数</span>
                            <span id="sjfycs" name="sjfycs"></span>
                        </div>
                        <div>
                            <span class="span-label">服药率(%)</span>
                            <span id="fyl" name="fyl"></span>
                        </div>
                    </div>
                </li>
                <li class="consLi">
                    <div class="cons-label">随访照片</div>
                    <div class="cons-txt">
                        <div class="consPic">
                            <div><img src="../../img/noload.png"></div>
                        </div>
                    </div>
                </li>
                <li class="consLi">
                    <div class="cons-label">医生签字</div>
                    <div class="cons-txt">
                        <div class="consQianm">
                            <div>医生未上传手写签名</div>
                        </div>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>
</body>
<script src="../../js/resizeDiv.js"></script>
<script>
	$(function () {
		//查询显示肺结核的列表
		getDataList();
	})
	//查询显示显示肺结核的列表
	function getDataList(){
		var jsonParam = new Object();
        jsonParam.jmId = parent.document.getElementById('archiveId').value;
        var authorCookie = getCookie("author");
        $.ajax({
            type: 'POST',
            dataType: "json",
            async: false,
            contentType: 'application/json',
            url: roadPath + '/health/follow/getFjhList',
            data: JSON.stringify(jsonParam),
            beforeSend: function (XMLHttpRequest) {
            	XMLHttpRequest.setRequestHeader("authToken", authorCookie);
            },
            success: function (res) {
            	if(res.retCode == 0){  
            		$(".wait").eq(0).css('display', 'none');
            		$("#listUl").html("");
            		if (res.data != '{}' && res.data.length > 0) {
            			for(var i = 0; i < res.data.length; i++){
            				for (var key in res.data[i]) {
                        		if (res.data[i][key] == null || res.data[i][key] == '') {
                        			res.data[i][key] = '无数据';
                        		}
                        	}
            				$("#listUl").append(
            					'<li class="docLi" ids="' + res.data[i].id + '">'+
			                        '<div class="docLi-icon">'+
			                            '<div><i class="radius"></i><p>肺</p></div>'+
			                        '</div>'+
			                        '<div class="docLi-cont">'+
			                            '<div class="doc-cont">'+
			                                '<div>'+
			                                    '<span>随访医生</span>&nbsp;'+
			                                    '<span name="sfysName">' + (res.data[i].sfysName == '无数据' ? '': res.data[i].sfysName) + '</span>'+
			                                '</div>'+
			                                '<div class="doc-cont-rem" style="margin-top: 5px;">'+
			                                    '<span>随访方式</span>&nbsp;'+
			                                    '<span name="sffsName">' + res.data[i].sffsName + '</span>'+
			                                '</div>'+
			                            '</div>'+
			                            '<div class="doc-time" name="sfrq">' + res.data[i].sfrq + '</div>'+
			                        '</div>'+
			                    '</li>'
            				);
            				var userAgent = navigator.userAgent;
            				var reIE = new RegExp("MSIE (\\d+\\.\\d+);");
                            reIE.test(userAgent);
                            var fIEVersion = parseFloat(RegExp["$1"]);
            				if (fIEVersion == 7) {
            					$(".docLi-cont").css ({
                		            width: $(".leftCard").width() - 80 + 'px'
                		        });
            				} else {
            					$(".docLi-cont").css ({
                		            width: $(".leftCard").width() - 80 + 'px'
                		        });
            				}
            			}
            			getDetail (res.data[0].id);
            			$("#listUl").find(".docLi").eq(0).addClass("liact");
            		} else {
            			$(".nodata").eq(0).css('display', 'block');
            		}          	
            	}
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
            
            }
        });
	}
	$("#listUl").on("click", ".docLi", function () {
		$("#listUl").find(".docLi").removeClass("liact");
		$(this).addClass("liact");
		var ids = $(this).attr("ids");
		getDetail(ids);
	})
	function getDetail (ids) {
		var jsonParam = new Object();
		jsonParam.id = ids;
		var authorCookie = getCookie("author");
		var detailArr = [
			'zlyx', 'ddryName', 'sffsName', 'zzjtzName', 'xyl', 'yjl',
			'hlfa', 'yyyfName', 'ypjxName', 'lfycs', 'ywblfyms', 'bfzhhbzms',
			'zzkb', 'zzyy', 'zzsfjg', 'zzclyj', 'xcsfsj', 'tzzlsj', 'tzzlyy', 
			'yfshzcs', 'sjfscs', 'yfycs', 'sjfycs', 'fyl'
		];
		$("#yaowutable tbody").html("");
		$.ajax({
            type: 'POST',
            dataType: "json",
            async: false,
            contentType: 'application/json',
            url: roadPath + '/health/follow/getFjh',
            data: JSON.stringify(jsonParam),
            beforeSend: function (XMLHttpRequest) {
            	XMLHttpRequest.setRequestHeader("authToken", authorCookie);
            },
            success: function (res) {
            	if(res.retCode == 0){
            		for (var key in res.data) {
                		if (res.data[key] == null || res.data[key] == '') {
                			res.data[key] = '无数据';
                		}
                	}
					for (var i = 0; i < detailArr.length; i++) {
						var zang = (detailArr[i] + "").replace(/\d+/g,'');
						$("#"+detailArr[i]).html(res.data[zang]);
					}				
            	}
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
            
            }
        });
	}
</script>
</html>